<!DOCTYPE html>
<html ng-app data-cast-api-enabled="true">
<head>

<!--
 *
 * FM4cast - FM4 chromecasts receiver/sender
 * http://sehaas.github.io/fm4cast
 *
 * Copyright 2013,2014 Sebastian Haas (sehaas@deebas.com)
 * Released under the MIT license
 *
 *
//-->
 
	<title>FM4 chromecast Player</title>
	<script src="../js/jquery.min.js"></script>
	<script src="../js/jquery-ui.js"></script>

	<script src="../js/apikey.js"></script><!-- make sure your apikeyfile is there -->
	<script src="../js/FM4Player.js"></script>
	<link rel="stylesheet" type="text/css" href="../css/jquery-ui.css"></head>
	<link rel="stylesheet" type="text/css" href="../css/FM4Sender.css"></head>
	<style type="text/css">
		#player-status,
		#media-status {
			width: 99%;
			height: 300px;
			overflow: auto;
		}

		#player {
			width:400px;
			height:250px;
			background-color:white;
		}

		#slider {
			margin:20px;
		}
	</style>
<body>
	<ul id="receiver"></ul>

	<div id="player">

		<div id="slider">
		</div>
	</div>


	<div id="player-status">
	</div>

	<div id="media-status">
	</div>

	<script type="text/javascript">
		(function($) {
			var player = window.player = new $.FM4Player(fm4c.config.apikey);
			$(player).on("cast-receiver-list", function(evnt, list){
				var recList = $('#receiver');
				recList.empty();
				$.each(list, function(idx, val){
					var rec = $('<li>');
					rec.text(val.name);
					rec.on('click', val, function(e){
						player.connect(e.data);
					});
					recList.append(rec);
				});
			});

			player.init();

			$("#slider").slider();
			$("#slider").on("slidestop", function(e, ui) {
				player.play(ui.value);
			});

			$(player).on("cast-media-player-status", function(e,s){
				var elem = $("<div>");
				elem.text(JSON.stringify(s));
				$("#player-status").prepend(elem);

				if (s.duration) {
					$("#slider").slider("option", {
						value: s.position,
						range: "min",
						min: 0,
						max: s.duration,
						disabled: false,
					});
				} else {
					$("#slider").slider("option", {
						value: 0,
						range: "min",
						min: 0,
						max: 1,
						disabled : true,
					});
				}
			});
			$(player).on("cast-media-status", function(e,s){
				var elem = $("<div>");
				elem.text(JSON.stringify(s));
				$("#media-status").prepend(elem);
			});
		}(jQuery));
	</script>
</body>
</html>
